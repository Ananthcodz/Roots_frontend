# Implementation Plan

- [x] 1. Set up core infrastructure and contexts
  - [x] 1.1 Create FamilyContext with state management for family members and relationships
    - Implement context provider with state for family members, relationships, loading states
    - Add methods: addFamilyMember, updateFamilyMember, getFamilyMembers, getRelationships
    - _Requirements: 1.1, 1.4, 1.5, 2.1-2.5, 3.1-3.5, 4.1-4.5, 5.1-5.5_
  - [x] 1.2 Create MemoryContext with state management for photos and albums
    - Implement context provider with state for memories, albums, upload progress
    - Add methods: uploadPhotos, createMemory, getAlbums, searchFamilyMembers
    - _Requirements: 6.1-6.5, 7.1-7.5, 8.1-8.5, 9.1-9.5, 10.1-10.5_
  - [x] 1.3 Create FamilyService for API interactions
    - Implement addFamilyMember, updateFamilyMember, getFamilyMembers, getRelationships API calls
    - Include error handling and request/response formatting
    - _Requirements: 5.3, 5.4, 5.5_
  - [x] 1.4 Create MemoryService for photo upload and memory management
    - Implement uploadPhotos, createMemory, getAlbums, searchMembers API calls
    - Include file upload with progress tracking
    - Reuse UserService.compressImage for photo compression
    - _Requirements: 10.3, 10.4_
  - [x] 1.5 Create InviteService for family tree invitations
    - Implement validateInviteCode, joinTree, getPendingInvitations, acceptInvitation, declineInvitation API calls
    - _Requirements: 12.1, 12.3, 12.4, 12.5, 13.5, 14.3, 14.4_

- [x] 2. Create reusable components
  - [x] 2.1 Create BackLink component for navigation
    - Implement link component with icon and customizable destination
    - Add keyboard accessibility
    - _Requirements: 1.2, 15.1, 15.3_
  - [x] 2.2 Create DateInput component with format validation
    - Implement input with DD/MM/YYYY format placeholder
    - Add format validation and error display
    - Support keyboard input and date parsing
    - _Requirements: 3.4, 8.3_
  - [x] 2.3 Write property test for DateInput validation
    - **Property: Date format validation**
    - **Validates: Requirements 3.4**
  - [x] 2.4 Create Toggle component for boolean values
    - Implement accessible toggle switch with label
    - Support keyboard interaction (Space/Enter to toggle)
    - _Requirements: 4.1, 4.2_
  - [x] 2.5 Write property test for Toggle state transitions
    - **Property 3: Living status toggle updates state**
    - **Validates: Requirements 4.2**
  - [x] 2.6 Create PhotoDropzone component for file uploads
    - Implement drag-and-drop area with click-to-upload
    - Add file type and size validation
    - Display validation errors
    - _Requirements: 6.3, 6.4, 7.4, 7.5_
  - [x] 2.7 Write property test for PhotoDropzone file validation
    - **Property: File validation**
    - **Validates: Requirements 7.4, 7.5**
  - [x] 2.8 Create PhotoPreviewGrid component
    - Display thumbnails of selected photos
    - Show photo count and "Clear all" button
    - Support individual photo removal
    - _Requirements: 7.1, 7.2, 7.3_
  - [x] 2.9 Write property test for PhotoPreviewGrid
    - **Property 7: Photo selection creates previews**
    - **Property 8: Clear all removes all photos**
    - **Validates: Requirements 7.1, 7.3_
  - [x] 2.10 Create TagSearch component for family member tagging
    - Implement searchable dropdown with debounced search
    - Display selected tags with remove buttons
    - _Requirements: 8.4, 8.5, 9.1, 9.2, 9.3_
  - [x] 2.11 Write property test for TagSearch
    - **Property 9: Family member search returns matching results**
    - **Property 10: Tag management maintains consistency**
    - **Validates: Requirements 8.5, 9.1, 9.2, 9.3**
  - [x] 2.12 Create InviteCodeInput component
    - Implement input with 6-character format validation
    - Auto-format input (uppercase, optional hyphen)
    - Display validation errors
    - _Requirements: 11.5, 12.1_
  - [x] 2.13 Write property test for InviteCodeInput validation
    - **Property 13: Invite code format validation**
    - **Validates: Requirements 12.1**

- [x] 3. Implement Add Family Member page
  - [x] 3.1 Create AddFamilyMemberPage component structure
    - Set up page layout with NavigationBar and BackLink
    - Add page header with title and subtitle
    - Create form sections: Relationship, Personal Info, Contact & Status
    - _Requirements: 1.1, 1.2, 1.3_
  - [x] 3.2 Implement Relationship section
    - Add "Related to" dropdown pre-populated with current user
    - Add "Relationship Type" dropdown with all relationship options
    - Add optional "Specific Label" text input
    - _Requirements: 1.4, 1.5, 2.1, 2.2, 2.3, 2.4_
  - [x] 3.3 Write property test for relationship context updates
    - **Property 1: Relationship context updates correctly**
    - **Validates: Requirements 1.5**
  - [x] 3.4 Write property test for specific label validation
    - **Property 2: Specific label accepts valid characters**
    - **Validates: Requirements 2.4**
  - [x] 3.5 Implement Personal Information section
    - Add ImageUpload component for profile photo
    - Add First Name and Last Name inputs
    - Add DateInput for date of birth
    - Add Gender selection (Male/Female)
    - _Requirements: 3.1, 3.2, 3.3, 3.4, 3.5_
  - [x] 3.6 Implement Contact and Status section
    - Add Toggle for living status
    - Add email input with validation
    - Add "Send invite" checkbox
    - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5_
  - [x] 3.7 Write property test for email validation
    - **Property 4: Email validation correctly identifies valid and invalid emails**
    - **Validates: Requirements 4.4**
  - [x] 3.8 Implement form validation and submission
    - Add client-side validation for all required fields
    - Display inline validation errors
    - Implement Cancel button (navigate to dashboard)
    - Implement Add Member button with loading state
    - _Requirements: 2.5, 5.1, 5.2, 5.3, 5.4, 5.5_
  - [x] 3.9 Write property test for form validation
    - **Property 5: Valid form submission creates family member**
    - **Property 6: Form validation identifies all invalid fields**
    - **Validates: Requirements 5.3, 5.4, 5.5**
  - [x] 3.10 Integrate with FamilyContext and FamilyService
    - Connect form to FamilyContext
    - Handle API responses and errors
    - Navigate to dashboard on success
    - _Requirements: 5.3_
  - [x] 3.11 Add route to App.jsx
    - Add /add-family-member protected route
    - Update QuickActions component to navigate to new route
    - _Requirements: 1.1_

- [x] 4. Checkpoint - Ensure all tests pass
  - Ensure all tests pass, ask the user if questions arise.

- [x] 5. Implement Upload Photos page
  - [x] 5.1 Create UploadPhotosPage component structure
    - Set up page layout with NavigationBar and BackLink
    - Add page header with title and subtitle
    - Create two-column layout: upload area and details panel
    - _Requirements: 6.1, 6.2_
  - [x] 5.2 Implement photo upload area
    - Add PhotoDropzone component
    - Add PhotoPreviewGrid component
    - Handle file selection and preview generation
    - _Requirements: 6.3, 6.4, 6.5, 7.1, 7.2, 7.3, 7.4, 7.5_
  - [x] 5.3 Implement memory details panel
    - Add "Select Album" dropdown
    - Add "Location" text input
    - Add DateInput for "Date Taken"
    - Add TagSearch for "Tagged People"
    - Add "Description" textarea with 500 character limit
    - _Requirements: 8.1, 8.2, 8.3, 8.4, 8.5, 9.1, 9.2, 9.3, 9.4, 9.5_
  - [x] 5.4 Write property test for description character limit
    - **Property 11: Description character limit enforcement**
    - **Validates: Requirements 9.5**
  - [x] 5.5 Implement form submission
    - Add Cancel button (navigate to dashboard)
    - Add Post Memories button with loading state
    - Show upload progress indicator
    - Handle upload errors and partial failures
    - Navigate to dashboard on success with success message
    - _Requirements: 10.1, 10.2, 10.3, 10.4, 10.5_
  - [x] 5.6 Write property test for photo upload
    - **Property 12: Valid photo upload creates memory records**
    - **Validates: Requirements 10.3**
  - [x] 5.7 Integrate with MemoryContext and MemoryService
    - Connect form to MemoryContext
    - Handle photo compression before upload
    - Handle API responses and errors
    - _Requirements: 10.3, 10.4_
  - [x] 5.8 Add route to App.jsx
    - Add /upload-photos protected route
    - Update QuickActions component to navigate to new route
    - _Requirements: 6.1_

- [x] 6. Checkpoint - Ensure all tests pass
  - Ensure all tests pass, ask the user if questions arise.

- [x] 7. Implement Join Family Tree page
  - [x] 7.1 Create JoinFamilyTreePage component structure
    - Set up page layout with NavigationBar
    - Create centered card layout with icon
    - Add page title and instructions
    - _Requirements: 11.1, 11.2, 11.3, 11.4_
  - [x] 7.2 Implement invite code input section
    - Add InviteCodeInput component
    - Add "Join Family Tree" button with arrow icon
    - Handle code validation and submission
    - Display error messages for invalid/expired codes
    - _Requirements: 11.5, 12.1, 12.2, 12.3, 12.4, 12.5_
  - [x] 7.3 Write property test for invite code joining
    - **Property 14: Valid invite code joins tree**
    - **Validates: Requirements 12.3**
  - [x] 7.4 Implement alternative actions section
    - Add "OR" divider
    - Add "Search for a family member" link with icon
    - Handle navigation to search interface
    - _Requirements: 13.1, 13.2, 13.3_
  - [x] 7.5 Implement pending invitations section
    - Fetch pending invitations on page load
    - Display invitation cards with tree name, inviter, and timestamp
    - Add Accept and Decline buttons for each invitation
    - Hide section when no invitations exist
    - _Requirements: 13.4, 13.5, 14.1, 14.2, 14.5_
  - [x] 7.6 Write property test for invitation display
    - **Property 15: Invitation display shows complete information**
    - **Validates: Requirements 13.5, 14.1**
  - [x] 7.7 Implement invitation actions
    - Handle Accept button click (join tree and remove invitation)
    - Handle Decline button click (remove invitation)
    - Update UI after action completes
    - _Requirements: 14.3, 14.4_
  - [x] 7.8 Write property test for invitation actions
    - **Property 16: Accept invitation adds user and removes invitation**
    - **Property 17: Decline invitation removes invitation without joining**
    - **Validates: Requirements 14.3, 14.4**
  - [x] 7.9 Integrate with InviteService
    - Connect to InviteService for all API calls
    - Handle API responses and errors
    - Show loading states during operations
    - _Requirements: 12.3, 14.3, 14.4_
  - [x] 7.10 Add route to App.jsx
    - Add /join-tree protected route
    - Update QuickActions component to navigate to new route
    - _Requirements: 11.1_

- [x] 8. Implement navigation and accessibility features
  - [x] 8.1 Ensure NavigationBar appears on all Quick Action pages
    - Verify navigation bar displays on all three pages
    - Verify user profile photo and name display correctly
    - _Requirements: 15.1, 15.2_
  - [x] 8.2 Add keyboard navigation support
    - Ensure all interactive elements are keyboard accessible
    - Add visible focus indicators
    - Test tab order follows logical flow
    - _Requirements: 15.3_
  - [x] 8.3 Add screen reader support
    - Add ARIA labels to all form fields and buttons
    - Add ARIA live regions for error messages
    - Add descriptive alt text for images and icons
    - _Requirements: 15.4_
  - [x] 8.4 Ensure responsive design
    - Test all pages on mobile, tablet, and desktop viewports
    - Adjust layouts for smaller screens
    - Ensure touch targets are at least 44x44px
    - _Requirements: 15.5_

- [x] 9. Add error handling and loading states
  - [x] 9.1 Implement error handling for FamilyService
    - Handle network errors with retry option
    - Display user-friendly error messages
    - Handle validation errors from server
    - _Requirements: 5.3, 5.4_
  - [x] 9.2 Implement error handling for MemoryService
    - Handle upload failures with retry option
    - Handle partial upload failures
    - Display progress and error states
    - _Requirements: 10.3, 10.4_
  - [x] 9.3 Implement error handling for InviteService
    - Handle invalid invite codes
    - Handle expired invite codes
    - Handle "already member" errors
    - _Requirements: 12.4, 12.5_
  - [x] 9.4 Add loading states to all async operations
    - Show loading spinners during API calls
    - Disable buttons during submission
    - Show upload progress for photos
    - _Requirements: 10.4_

- [-] 10. Final checkpoint - Ensure all tests pass
  - Ensure all tests pass, ask the user if questions arise.
